<div class="teacher-form-container">
  <form class="teacher-form">
    
    <!-- Step Progress Indicator -->
    @if (!isViewMode) {
      <div class="step-indicator">
        <div class="step" 
             [class.active]="currentStep === STEP_PERSONAL"
             [class.completed]="isStepCompleted(STEP_PERSONAL)"
             (click)="goToStep(STEP_PERSONAL)">
          <div class="step-icon">
            <i class="fa-solid fa-user"></i>
          </div>
          <span class="step-label">Personal Info</span>
        </div>

        <div class="step-line" [class.completed]="currentStep > STEP_PERSONAL"></div>

        <div class="step"
             [class.active]="currentStep === STEP_ACCOUNT"
             [class.completed]="isStepCompleted(STEP_ACCOUNT)"
             (click)="goToStep(STEP_ACCOUNT)">
          <div class="step-icon">
            <i class="fa-solid fa-id-card"></i>
          </div>
          <span class="step-label">Account Setup</span>
        </div>

        <div class="step-line" [class.completed]="currentStep > STEP_ACCOUNT"></div>

        <div class="step"
             [class.active]="currentStep === STEP_LOCATION"
             [class.completed]="isStepCompleted(STEP_LOCATION)"
             (click)="goToStep(STEP_LOCATION)">
          <div class="step-icon">
            <i class="fa-solid fa-location-dot"></i>
          </div>
          <span class="step-label">Location Info</span>
        </div>
      </div>
    }

    <!-- Step 1: Personal Information -->
    @if (currentStep === STEP_PERSONAL) {
      <div class="form-step">
        <h3 class="step-title">Personal Information</h3>
        
        <div class="form-group">
          <label for="full_name" class="form-label">Full Name <span class="required">*</span></label>
          <input
            type="text"
            id="full_name"
            name="full_name"
            class="form-input"
            [(ngModel)]="formData.full_name"
            (ngModelChange)="onFullNameChange()"
            [disabled]="isViewMode"
            required
            placeholder="Enter full name"
          />
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="first_name" class="form-label">First Name <span class="required">*</span></label>
            <input
              type="text"
              id="first_name"
              name="first_name"
              class="form-input"
              [(ngModel)]="formData.first_name"
              (ngModelChange)="onFormFieldChange()"
              [disabled]="isViewMode"
              required
              placeholder="First name"
            />
          </div>

          <div class="form-group">
            <label for="middle_name" class="form-label">Middle Name <span class="optional">(optional)</span></label>
            <input
              type="text"
              id="middle_name"
              name="middle_name"
              class="form-input"
              [(ngModel)]="formData.middle_name"
              [disabled]="isViewMode"
              placeholder="Middle name"
            />
          </div>

          <div class="form-group">
            <label for="last_name" class="form-label">Last Name <span class="required">*</span></label>
            <input
              type="text"
              id="last_name"
              name="last_name"
              class="form-input"
              [(ngModel)]="formData.last_name"
              (ngModelChange)="onFormFieldChange()"
              [disabled]="isViewMode"
              required
              placeholder="Last name"
            />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="date_of_birth" class="form-label">Date of Birth <span class="optional">(optional)</span></label>
            <input
              type="date"
              id="date_of_birth"
              name="date_of_birth"
              class="form-input"
              [(ngModel)]="formData.date_of_birth"
              [disabled]="isViewMode"
            />
          </div>

          <div class="form-group">
            <label for="age" class="form-label">Age <span class="optional">(optional)</span></label>
            <input
              type="number"
              id="age"
              name="age"
              class="form-input"
              [(ngModel)]="formData.age"
              [disabled]="isViewMode"
              placeholder="Age"
            />
          </div>

          <div class="form-group">
            <label for="gender" class="form-label">Gender <span class="optional">(optional)</span></label>
            <select
              id="gender"
              name="gender"
              class="form-input"
              [(ngModel)]="formData.gender"
              [disabled]="isViewMode"
            >
              <option value="">Select Gender</option>
              <option value="MALE">Male</option>
              <option value="FEMALE">Female</option>
              <option value="OTHER">Other</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="teacher_qualification" class="form-label">Qualification <span class="optional">(optional)</span></label>
            <input
              type="text"
              id="teacher_qualification"
              name="teacher_qualification"
              class="form-input"
              [(ngModel)]="formData.teacher_qualification"
              [disabled]="isViewMode"
              placeholder="Enter qualification (e.g., MS Computer Science)"
            />
          </div>

          <div class="form-group">
            <label for="joining_date" class="form-label">Joining Date <span class="optional">(optional)</span></label>
            <input
              type="date"
              id="joining_date"
              name="joining_date"
              class="form-input"
              [(ngModel)]="formData.joining_date"
              [disabled]="isViewMode"
            />
          </div>
        </div>
      </div>
    }

    <!-- Step 2: Account Setup -->
    @if (currentStep === STEP_ACCOUNT) {
      <div class="form-step">
        <h3 class="step-title">Account Setup</h3>

        <div class="form-row">
          <div class="form-group">
            <label for="username" class="form-label">Username <span class="required">*</span></label>
            <input
              type="text"
              id="username"
              name="username"
              class="form-input"
              [(ngModel)]="formData.username"
              (ngModelChange)="onFormFieldChange()"
              [disabled]="isViewMode || isEditMode"
              required
              placeholder="Enter username"
            />
          </div>

          @if (!isEditMode) {
            <div class="form-group">
              <label for="password" class="form-label">Password <span class="required">*</span></label>
              <input
                type="password"
                id="password"
                name="password"
                class="form-input"
                [(ngModel)]="formData.password"
                (ngModelChange)="onFormFieldChange()"
                [disabled]="isViewMode"
                required
                placeholder="Enter password"
              />
            </div>
          }

          <div class="form-group">
            <label for="email_address" class="form-label">Email Address <span class="required">*</span></label>
            <input
              type="email"
              id="email_address"
              name="email_address"
              class="form-input"
              [(ngModel)]="formData.email_address"
              (ngModelChange)="onFormFieldChange()"
              [disabled]="isViewMode"
              required
              placeholder="Enter email"
            />
          </div>
        </div>

        <!-- Navigation Buttons -->
      </div>
    }

    <!-- Step 3: Location Information -->
    @if (currentStep === STEP_LOCATION) {
      <div class="form-step">
        <h3 class="step-title">Location Information</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label for="country_id" class="form-label">Country <span class="optional">(optional)</span></label>
            <select
              id="country_id"
              name="country_id"
              class="form-input"
              [(ngModel)]="formData.country_id"
              (ngModelChange)="onCountryChange()"
              [disabled]="isViewMode || isLoadingCountries"
            >
              <option [value]="null">Select Country</option>
              <option *ngFor="let country of countries" [value]="country.country_id">
                {{ country.name }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="state_id" class="form-label">State <span class="optional">(optional)</span></label>
            <select
              id="state_id"
              name="state_id"
              class="form-input"
              [(ngModel)]="formData.state_id"
              (ngModelChange)="onStateChange()"
              [disabled]="isViewMode || !formData.country_id || isLoadingStates"
            >
              <option [value]="null">Select State</option>
              <option *ngFor="let state of states" [value]="state.state_id">
                {{ state.name }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label for="city_id" class="form-label">City <span class="optional">(optional)</span></label>
            <select
              id="city_id"
              name="city_id"
              class="form-input"
              [(ngModel)]="formData.city_id"
              [disabled]="isViewMode || !formData.state_id || isLoadingCities"
            >
              <option [value]="null">Select City</option>
              <option *ngFor="let city of cities" [value]="city.city_id">
                {{ city.name }}
              </option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="address" class="form-label">Address <span class="optional">(optional)</span></label>
          <textarea
            id="address"
            name="address"
            class="form-input"
            rows="3"
            [(ngModel)]="formData.address"
            [disabled]="isViewMode"
            placeholder="Enter complete address"
          ></textarea>
        </div>

        <div class="form-group">
          <label for="zip_code" class="form-label">Zip Code <span class="optional">(optional)</span></label>
          <input
            type="text"
            id="zip_code"
            name="zip_code"
            class="form-input"
            [(ngModel)]="formData.zip_code"
            [disabled]="isViewMode"
            placeholder="Enter zip code"
          />
        </div>

        <!-- Navigation Buttons -->

      </div>
    }
  </form>
</div>
